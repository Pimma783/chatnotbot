// data/mju_comsci_extended_knowledge.ts

/**
 * Knowledge Base (Mockup Data) สำหรับภาควิชาวิทยาการคอมพิวเตอร์ ม.แม่โจ้
 * ใช้สำหรับเทคนิค RAG (Retrieval-Augmented Generation)
 */
export const extendedKnowledgeBase: string[] = [
    // === 1. ข้อมูลติดต่อและที่ตั้ง ===
    "มหาวิทยาลัยแม่โจ้ (Maejo University) ตั้งอยู่ที่ 63 หมู่ 4 ต.หนองหาร อ.สันทราย จ.เชียงใหม่ 50290.",
    "เบอร์โทรศัพท์กลางของมหาวิทยาลัยคือ 053-873000 และเว็บไซต์หลักคือ www.mju.ac.th.",
    "ภาควิชาวิทยาการคอมพิวเตอร์ (CS) สังกัดคณะวิทยาศาสตร์.",
    "สำนักงานภาควิชาวิทยาการคอมพิวเตอร์ตั้งอยู่ที่ อาคารจุฬาภรณ์ ชั้น 3.",
    "เบอร์โทรศัพท์ติดต่อภาควิชาโดยตรงคือ 053-873-888 (Mockup).",

    // === 2. หลักสูตรและการเรียนการสอน ===
    "หลักสูตรที่เปิดสอนคือ วิทยาศาสตรบัณฑิต สาขาวิชาวิทยาการคอมพิวเตอร์ (วท.บ. วท.ค.).",
    "หลักสูตร CS เน้นการพัฒนาซอฟต์แวร์ประยุกต์, ระบบฐานข้อมูล, และความรู้ด้านปัญญาประดิษฐ์ (AI) และ Machine Learning.",
    "ปี 1 เน้นวิชาพื้นฐานคณิตศาสตร์และวิทยาศาสตร์, ปี 2 เริ่มเรียนการเขียนโปรแกรมเชิงวัตถุ (OOP) และ Data Structure.",
    "วิชาเลือกที่น่าสนใจคือ Blockchain Technology, Cloud Computing, และ IoT for Agriculture.",
    "มีการเรียนการสอนแบบ PBL (Problem-Based Learning) โดยร่วมมือกับฟาร์มทดลองของมหาวิทยาลัย.",
    "นักศึกษาต้องทำโปรเจกต์จบ (Senior Project) ในชั้นปีที่ 4 และสามารถเลือกทำเป็นแอพพลิเคชันหรือวิจัย.",

    // === 3. การรับสมัครและค่าธรรมเนียม ===
    "เกณฑ์การรับสมัครหลักใช้คะแนน A-Level ในวิชา คณิตศาสตร์1, ฟิสิกส์, และภาษาอังกฤษ ผ่านระบบ TCAS.",
    "รอบโควต้า (TCAS 2) มักจะเปิดรับช่วงเดือนกุมภาพันธ์ โดยใช้ GPAX และ Portfolio ประกอบ.",
    "ค่าธรรมเนียมการศึกษาโดยประมาณสำหรับหลักสูตร CS คือ 18,500 บาทต่อภาคเรียน (Mockup Data).",
    "มหาวิทยาลัยมีทุนการศึกษาสำหรับนักศึกษาที่มีผลการเรียนดีเด่น หรือขาดแคลนทุนทรัพย์ (สอบถามที่กองพัฒนานักศึกษา).",

    // === 4. สิ่งอำนวยความสะดวกและกิจกรรม ===
    "ห้องปฏิบัติการคอมพิวเตอร์หลัก (Lab) เปิดให้บริการจนถึง 20:00 น. ในช่วงวันทำการเรียน.",
    "นักศึกษาสามารถยืมอุปกรณ์ IT เช่น Laptop หรือ Tablet สำหรับการเรียนได้ที่สำนักหอสมุด.",
    "กิจกรรมเด่นของภาควิชาคือ 'MJU Coding War' และ 'IT Camp' สำหรับนักเรียนมัธยม.",
    "มีชมรม e-Sports และชมรมพัฒนาซอฟต์แวร์ (Developer Club) ภายใต้การดูแลของภาควิชา.",
    "โรงอาหารหลักอยู่ใกล้กับอาคารจุฬาภรณ์ เดินทางไปได้ภายใน 5 นาที.",
    
    // === 5. โอกาสในการทำงาน ===
    "ศิษย์เก่าส่วนใหญ่ทำงานเป็น Software Developer, Data Analyst, และ System Administrator ในบริษัท Tech.",
    "เนื่องจากแม่โจ้เน้นเกษตร นักศึกษาสาขา CS มีความโดดเด่นในการพัฒนา Agri-Tech และ Smart Farm Solutions.",
    "มีการจัดงาน Job Fair และ Career Talk ประจำปี เพื่อให้นักศึกษาพบปะบริษัทชั้นนำ.",
];

/**
 * ฟังก์ชัน Mockup Retrieval สำหรับการค้นหาข้อมูลที่เกี่ยวข้องจาก Knowledge Base
 * (ปรับปรุงให้รองรับ Keywords ที่กว้างขึ้น)
 * @param query ข้อความคำถามจากผู้ใช้
 * @returns ข้อมูลบริบทที่เกี่ยวข้องกับคำถาม
 */
export function mockRetrieval(query: string): string {
    const queryLower = query.toLowerCase();
    
    // กำหนด Keywords ที่เกี่ยวข้อง
    const baseKeywords = [
        "หลักสูตร", "ค่าเทอม", "สมัคร", "ติดต่อ", "คณะ", "ฝึกงาน", "วิชา", "อาคาร", 
        "หอพัก", "ทุน", "กิจกรรม", "ที่ตั้ง", "จบ", "ทำงาน", "e-sports", "คอมพิวเตอร์"
    ];
    
    // สร้าง Keywords จาก Query ของผู้ใช้ (กรองคำสั้นๆ)
    const userKeywords = queryLower.split(' ').filter(k => k.length > 2);
    const searchTerms = Array.from(new Set([...baseKeywords, ...userKeywords]));

    const relevantChunks = extendedKnowledgeBase.filter(chunk => 
        searchTerms.some(term => chunk.toLowerCase().includes(term))
    );

    if (relevantChunks.length === 0) {
        // หากไม่พบ keyword ตรงๆ เลย
        return extendedKnowledgeBase.slice(0, 3).join('\n---\n') + 
               "\n---\n" +
               "ไม่พบข้อมูลที่เกี่ยวข้องโดยตรงในฐานข้อมูล กรุณาลองถามด้วยคำที่เฉพาะเจาะจงมากขึ้น.";
    }

    // รวมข้อมูลที่เกี่ยวข้องทั้งหมดเป็น string เดียว
    return relevantChunks.join('\n---\n');
}